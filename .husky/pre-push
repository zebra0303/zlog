#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ“Š ì¸¡ì • ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰: Lighthouse Core Web Vitals ì¸¡ì • ì¤‘..."
npm run vitals -w client

# vitals ìŠ¤í¬ë¦½íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸
if [ $? -eq 0 ]; then
  # ë³€ê²½ëœ ë‚´ìš©ì´ ìˆëŠ”ì§€ í™•ì¸
  if ! git diff --quiet .ai-vitals.md; then
    # echo "ğŸ“ .ai-vitals.md íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."
    echo "ğŸ“ .ai-vitals.md íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤. ì¶”ê°€ ì¤‘..."
    # # prettier ì ìš©
    npx prettier --write .ai-vitals.md
    
    git add .ai-vitals.md
    # git commit -m "chore: update Lighthouse Core Web Vitals (.ai-vitals.md)" --no-verify
    echo "âœ… .ai-vitals.md ì—…ë°ì´íŠ¸ ë° ì¶”ê°€ ì™„ë£Œ."
  else
    echo "âš¡ ì„±ëŠ¥ ì§€í‘œì— ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤."
  fi
else
  echo "âŒ Lighthouse ì¸¡ì • ì‹¤íŒ¨. í‘¸ì‹œë¥¼ ì¤‘ë‹¨í•©ë‹ˆë‹¤."
  exit 1
fi